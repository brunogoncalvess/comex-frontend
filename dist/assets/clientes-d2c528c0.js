import{u as E,D as q}from"./index-78858509.js";/* empty css              */class P{constructor(t,r,o,n,S){this.nome=t,this.sobrenome=r,this.cpf=o,this.telefone=n,this.endereco=S}criaCliente(){return{id:E.v4(),nome:this.nome,sobrenome:this.sobrenome,cpf:this.cpf,telefone:this.telefone,endereco:this.endereco,criacao:q.data()}}}class C{constructor(t,r,o,n){this.logradouro=t,this.bairro=r,this.cidade=o,this.numero=n,this.logradouro=t,this.bairro=r,this.cidade=o,this.numero=n}criaEndereco(){return{logradouro:this.logradouro,bairro:this.bairro,cidade:this.cidade,numero:this.numero}}}const c=document.querySelector(".cliente__btn"),k=document.querySelector(".cliente__input-cep-btn"),u=document.querySelector("#logradouro"),d=document.querySelector("#bairro"),f=document.querySelector("#cidade"),v=document.querySelector("#numero"),a=document.querySelector("#nome"),m=document.querySelector("#sobrenome"),s=document.querySelector("#cpf"),y=document.querySelector("#telefone"),p=document.querySelector("#cep");document.querySelectorAll(".validate").forEach(e=>{e.addEventListener("blur",t=>T(t.target))});let h=!0,b=!0,i=!0,g=!0;function T(e){const t=e.parentElement.querySelector(".cliente__error");e.validity.valid?(t.style.display="none",h=!0,b=!0):(e.validity.valueMissing&&(t.innerText="Campo obrigatório.",h=!1),e.validity.tooShort&&(t.innerText="Adicione pelo menos 2 caracteres",b=!1),t.style.display="block")}s.addEventListener("blur",e=>_(e));function _(e){const t=e.target.parentElement.querySelector(".cliente__error"),r=e.target.value.replace(/\D+/g,"");if(r.length!=11){t.innerText="O CPF deve ter 11 dígitos.",t.style.display="block",i=!1;return}if(/^(\d)\1+$/.test(r)){t.innerText="CPF inválido.",t.style.display="block",i=!1;return}let o=0;for(let l=0;l<9;l++)o+=+r[l]*(10-l);let n=11-o%11;if((n>9?0:n)!==+r[9]){t.innerText="CPF inválido.",t.style.display="block",i=!1;return}o=0;for(let l=0;l<10;l++)o+=+r[l]*(11-l);if(n=11-o%11,(n>9?0:n)!==+r[10]){t.innerText="CPF inválido.",t.style.display="block",i=!1;return}t.style.display="none",i=!0}y.addEventListener("blur",e=>$(e));function $(e){const t=e.target.parentElement.querySelector(".cliente__error");if(e.target.value){if(e.target.value.replace(/[^0-9]+/g,"").length!=11){t.innerText="Telefone inválido",t.style.display="block",g=!1;return}t.style.display="none",g=!0}}function j(e){const t=e.split("").splice(0,3).join(""),r=e.split("").splice(3,3).join(""),o=e.split("").splice(6,3).join(""),n=e.split("").splice(-2,2).join("");return`${t}.${r}.${o}-${n}`}function D(e){if(e){const t=e.split("").splice(0,2).join(""),r=e.split("").splice(2,5).join(""),o=e.split("").splice(7,4).join("");return`(${t}) ${r}-${o}`}return""}c.addEventListener("click",()=>{if(!a.value||!m.value||!s.value||!u.value||!d.value||!f.value||!v.value||!h||!b||!i||!g){alert("Preencha todos os campos corretamente antes de enviar.");return}const e=new C(u.value,d.value,f.value,v.value).criaEndereco();x(e)});function x(e){c.disabled=!0,fetch("http://localhost:3000/clientes",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(new P(a.value,m.value,j(s.value),D(y.value),e).criaCliente())}).then(t=>{t.status===201&&(alert(`Cliente ${a.value} (${s.value}) cadastrado com sucesso.`),a.value=m.value=s.value=y.value=u.value=d.value=f.value=v.value="",a.focus(),c.disabled=!1)}).catch(t=>{alert("Não foi possível cadastrar o cliente! Aguarde uns minutos e tente novamente."),console.log("fetchErr::",t),c.disabled=!1})}k.onclick=async e=>{if(e.preventDefault(),!p.value)return;const r=await(await fetch(`https://viacep.com.br/ws/${p.value}/json/`)).json();p.value="",u.value=r.logradouro,d.value=r.bairro,f.value=r.localidade,v.focus()};
